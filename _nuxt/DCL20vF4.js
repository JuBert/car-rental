import{d as b,r as d,I as C,x as a,y as n,J as w,K as g,z as f,L as S,M as k,N as U,A as _,n as $,B as L,O as T,q as I}from"./BmSBCq59.js";import{u as N}from"./DmDwm_jH.js";const A={class:"relative w-64"},B=["placeholder"],M={key:0,class:"absolute z-10 bg-white border border-gray-300 w-full mt-1 rounded shadow"},V=["onClick"],z={key:1,class:"absolute right-2 top-2 text-gray-400 text-xs"},D={key:2,class:"text-red-500 mt-2 text-sm"},E=b({__name:"AutoCompleteInput",props:{apiUrl:{},errorMessage:{},placeholder:{}},emits:["select"],setup(h,{emit:m}){const r=h,l=d(""),o=d([]),i=d(!1),e=d(""),u=m;let c=null;const v=async t=>{try{const p=`${r.apiUrl}?search=${encodeURIComponent(t)}`,s=await $fetch(p);o.value=s.filter(y=>y.name.toLowerCase().includes(t.toLowerCase()))}catch{e.value=r.errorMessage||"Error fetching",o.value=[]}};C(l,t=>{if(c&&clearTimeout(c),e.value="",!t){o.value=[],e.value="";return}c=setTimeout(async()=>{i.value=!0,v(t),i.value=!1},300)});const x=t=>{l.value=t.name,o.value=[],e.value="",u("select",t)};return(t,p)=>(n(),a("div",A,[w(f("input",{"onUpdate:modelValue":p[0]||(p[0]=s=>l.value=s),type:"text",placeholder:t.placeholder||"Search...",class:"border border-gray-300 rounded px-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-400 transition"},null,8,B),[[S,l.value]]),o.value.length?(n(),a("ul",M,[(n(!0),a(k,null,U(o.value,s=>(n(),a("li",{key:s.id,onClick:y=>x(s),class:"px-4 py-2 hover:bg-blue-100 cursor-pointer"},_(s.name),9,V))),128))])):g("",!0),i.value?(n(),a("div",z," Loading... ")):g("",!0),e.value?(n(),a("div",D,_(e.value),1)):g("",!0),f("pre",null,"suggestions "+_(o.value),1)]))}}),O=Object.assign(E,{__name:"AutoCompleteInput"}),q=b({__name:"index",setup(h){const m=$(),r=N(),l=d(`${m.public.baseUrl}/stations`),o=e=>{r.value=e,i()},i=()=>{if(r.value){const e=r.value?.name?.toLowerCase();I({path:`/${e}`})}};return(e,u)=>{const c=O;return n(),a("div",null,[u[1]||(u[1]=f("p",null,"stations",-1)),L(c,{"api-url":T(l),placeholder:"Search for a station","error-message":"No stations found",onSelect:u[0]||(u[0]=v=>o(v))},null,8,["api-url"])])}}});export{q as default};
